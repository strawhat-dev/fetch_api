let e={configurable:!1,enumerable:!1,writable:!1},t={create:e,with:e,set:e,use:e,get:e,post:e,put:e,patch:e,delete:e,trace:e,connect:e,options:e,head:e},r=/* @__PURE__ */new Set(["ArrayBuffer","FormData","ReadableStream","SharedArrayBuffer","URLSearchParams"]),o=/* @__PURE__ */new Set(["Date","Error","Headers","RegExp","Request","Response","URL","URLSearchParams"]),n=/* @__PURE__ */new Set(["ArrayBuffer","AudioData","Blob","CropTarget","CryptoKey","DOMException","DOMMatrix","DOMMatrixReadOnly","DOMPoint","DOMPointReadOnly","DOMQuad","DOMRect","DOMRectReadOnly","File","FileList","FileSystemDirectoryHandle","FileSystemFileHandle","FileSystemHandle","GPUCompilationInfo","GPUCompilationMessage","ImageBitmap","ImageData","RTCCertificate","SharedArrayBuffer","VideoFrame"]),a=/* @__PURE__ */new Set(["get","post","put","patch","delete","trace","connect","options","head"]),i={100:"Continue",101:"SwitchingProtocols",102:"Processing",103:"EarlyHints",200:"Ok",201:"Created",202:"Accepted",203:"NonAuthoritativeInformation",204:"NoContent",205:"ResetContent",206:"PartialContent",207:"MultiStatus",208:"AlreadyReported",226:"ImUsed",300:"MultipleChoices",301:"MovedPermanently",302:"Found",303:"SeeOther",304:"NotModified",305:"UseProxy",306:"Unused",307:"TemporaryRedirect",308:"PermanentRedirect",400:"BadRequest",401:"Unauthorized",402:"PaymentRequired",403:"Forbidden",404:"NotFound",405:"MethodNotAllowed",406:"NotAcceptable",407:"ProxyAuthenticationRequired",408:"RequestTimeout",409:"Conflict",410:"Gone",411:"LengthRequired",412:"PreconditionFailed",413:"PayloadTooLarge",414:"UriTooLong",415:"UnsupportedMediaType",416:"RangeNotSatisfiable",417:"ExpectationFailed",418:"ImATeapot",421:"MisdirectedRequest",422:"UnprocessableEntity",423:"Locked",424:"FailedDependency",425:"TooEarly",426:"UpgradeRequired",428:"PreconditionRequired",429:"TooManyRequests",431:"RequestHeaderFieldsTooLarge",451:"UnavailableForLegalReasons",500:"InternalServerError",501:"NotImplemented",502:"BadGateway",503:"ServiceUnavailable",504:"GatewayTimeout",505:"HttpVersionNotSupported",506:"VariantAlsoNegotiates",507:"InsufficientStorage",508:"LoopDetected",510:"NotExtended",511:"NetworkAuthenticationRequired"},s=e=>{let t=c(e);if(y(e))return e;if(f(e))return e.cloneNode(!0);if(Array.isArray(e))return e.map(s);if("Set"===t)return new Set([...e].map(s));if("Map"===t)return new Map([...e].map(s));if(o.has(t))return new e.constructor(e);if(n.has(t)||ArrayBuffer.isView(e))return d(e);let r="function"==typeof e?e.bind({}):{};for(let t of Object.keys(e)){let o=e[t];y(o)||(o=s(o)),r[t]=o}return r},l=e=>{if(!e)return{};for(let t of Object.keys(e))delete e[t];return e},d=globalThis.structuredClone||(e=>e),c=e=>Object.prototype.toString.call(e).slice(8,-1),u=(e,...t)=>JSON.stringify("Map"===c(e)?Object.fromEntries(e):e?.[Symbol.iterator]?[...e]:e,...t),f=e=>"function"==typeof globalThis.Node&&"object"==typeof globalThis.Node.prototype&&e instanceof globalThis.Node,p=e=>m(e)||ArrayBuffer.isView(e)||r.has(c(e)),y=e=>!e||"object"!=typeof e&&"function"!=typeof e,h=e=>!!e&&"Promise"===c(e),b=e=>!!e&&"Request"===c(e),m=e=>{if("string"==typeof e)return!0;if(!e)return!1;let t=c(e);return"File"===t||"Blob"===t},g=(e,t,r)=>{if(!t&&!r)return e||"";let o=r?`?${new URLSearchParams(r)}`:"",n=(e?.url||`${e||""}`).trim();return(n.startsWith("http")&&n.startsWith(t)&&(t=""),n&&t)?O(`${t=t.replace(/\/+$/,"")}/${n=n.replace(/^\/+/,"")}${o}`,e):O(`${t||n}${o}`,e)},R=(e,...t)=>{let r=Object.assign({transform:"get"===e||"post"===e||"options"===e},...t,("get"===e||"head"===e)&&{body:void 0});if(null==r.body||p(r.body))return r;let o=r.headers??=new Headers,n=o.get("content-type");return n||o.set("content-type","application/json"),r.body=/multipart\/form-data/.test(n)?(o.delete("content-type"),S(r.body)):/application\/x-www-form-urlencoded/.test(n)?new URLSearchParams(r.body):u(r.body),r},w=(...e)=>{let t={};for(let{headers:r,appendHeaders:o}of e){if(r){if(t.headers)for(let e of("entries"in r||(r=Object.entries(r)),r))t.headers.set(...e);else t.headers=new Headers(r)}if(o){if(t.headers)for(let e of("entries"in o||(o=Object.entries(o)),o))t.headers.append(...e);else t.headers=new Headers(o)}}return t},O=(e,t)=>{let r=new URL(e);return b(t)?new Request(r,t):r},S=e=>{let t=new FormData;if(null==e)return t;for(let r of("object"==typeof e||(e={0:e}),Object.keys(e))){let o=e[r];m(o)||(o=u(o)),t.append(r,o)}return t},U=async(e,t,r)=>{r.method||=e.toUpperCase();let{onres:o,onError:n,transform:a,...s}=r,l={...s,input:t},d=await fetch(t,s).catch(M(l,n));if("error"in l)return d;if(d.status in i&&(d.code=i[d.status]),!d.ok){let{status:e="",code:t="UnsuccessfulResponse"}=d,r=Error(`${e} ${t}`.trim(),{cause:{status:e,code:t}});return M(d,n)(r)}let c=o?.await||o;if("function"==typeof c){let e=c(d,l),t=h(e)&&!("await"in o),r=t?void 0:await e;if(void 0!==r)return r}return a&&d.body&&!d.bodyUsed?d.json().catch(e=>e instanceof SyntaxError?e.message.match(/"(.*)" is not valid JSON$/)?.pop():M(d,n)(e)):d},M=(e,t)=>("function"==typeof t||(t=e=>e),r=>{(r||="Unknown Exception While Fetching...")instanceof Error||(r=Error(r));let o=setTimeout(()=>{console.error("Unhandled (in fetched-api)",r.stack||r)},10);return t(Object.defineProperty(e,"error",{enumerable:!0,configurable:!0,get:()=>(clearTimeout(o),r)})??e)}),P=e=>{let r=j();for(let t of(e&&Object.assign(r,s(e)),a)){let o="post"===t||"put"===t||"patch"===t;r[t]=(e,...n)=>{let a=n.pop();o&&(n.length?a.body=n.pop():a={body:a});let i=w(r,r[t],a),{baseURL:s,query:l,...d}=R(t,r,r[t],a,i);return U(t,g(e,s,l),d)},e?.[t]&&Object.assign(r[t],s(e[t]))}return Object.defineProperties(r,t)},j=()=>({create:P,with(e){let t=P(this);return e?t.use(e):t},set(e){for(let e of(l(this),a))l(this[e]);return this.use(e)},use(e){for(let t of Object.keys(e||{})){let r=e[t];y(r)||(r=s(r));let o="function"==typeof this[t];o?Object.assign(this[t],r):this[t]=r}return this}});var F=/* @__PURE__ */P();export{s as clone,F as default,P as initapi,u as jsonify,c as type};
