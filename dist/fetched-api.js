let e={configurable:!1,enumerable:!1,writable:!1},t={create:e,with:e,set:e,use:e,get:e,post:e,put:e,patch:e,delete:e,trace:e,connect:e,options:e,head:e},r=/* @__PURE__ */new Set(["ArrayBuffer","FormData","ReadableStream","SharedArrayBuffer","URLSearchParams"]),o=/* @__PURE__ */new Set(["Date","Error","Headers","RegExp","Request","Response","URL","URLSearchParams"]),n=/* @__PURE__ */new Set(["ArrayBuffer","AudioData","Blob","CropTarget","CryptoKey","DOMException","DOMMatrix","DOMMatrixReadOnly","DOMPoint","DOMPointReadOnly","DOMQuad","DOMRect","DOMRectReadOnly","File","FileList","FileSystemDirectoryHandle","FileSystemFileHandle","FileSystemHandle","GPUCompilationInfo","GPUCompilationMessage","ImageBitmap","ImageData","RTCCertificate","SharedArrayBuffer","VideoFrame"]),a=/* @__PURE__ */new Set(["get","post","put","patch","delete","trace","connect","options","head"]),i={100:"Continue",101:"SwitchingProtocols",102:"Processing",103:"EarlyHints",200:"Ok",201:"Created",202:"Accepted",203:"NonAuthoritativeInformation",204:"NoContent",205:"ResetContent",206:"PartialContent",207:"MultiStatus",208:"AlreadyReported",226:"ImUsed",300:"MultipleChoices",301:"MovedPermanently",302:"Found",303:"SeeOther",304:"NotModified",305:"UseProxy",306:"Unused",307:"TemporaryRedirect",308:"PermanentRedirect",400:"BadRequest",401:"Unauthorized",402:"PaymentRequired",403:"Forbidden",404:"NotFound",405:"MethodNotAllowed",406:"NotAcceptable",407:"ProxyAuthenticationRequired",408:"RequestTimeout",409:"Conflict",410:"Gone",411:"LengthRequired",412:"PreconditionFailed",413:"PayloadTooLarge",414:"UriTooLong",415:"UnsupportedMediaType",416:"RangeNotSatisfiable",417:"ExpectationFailed",418:"ImATeapot",421:"MisdirectedRequest",422:"UnprocessableEntity",423:"Locked",424:"FailedDependency",425:"TooEarly",426:"UpgradeRequired",428:"PreconditionRequired",429:"TooManyRequests",431:"RequestHeaderFieldsTooLarge",451:"UnavailableForLegalReasons",500:"InternalServerError",501:"NotImplemented",502:"BadGateway",503:"ServiceUnavailable",504:"GatewayTimeout",505:"HttpVersionNotSupported",506:"VariantAlsoNegotiates",507:"InsufficientStorage",508:"LoopDetected",510:"NotExtended",511:"NetworkAuthenticationRequired"},s=e=>null==e||Number.isNaN(e)?"Nullish":e.constructor?.name??Object.prototype.toString.call(e).slice(8,-1),l=e=>!d(e),d=e=>!e||"object"!=typeof e&&"function"!=typeof e,u=e=>!!e&&"Promise"===s(e),c=e=>!!e&&"Request"===s(e),f=e=>!!e?.ELEMENT_NODE&&"function"==typeof e.cloneNode,p=e=>y(e)||ArrayBuffer.isView(e)||r.has(s(e)),y=e=>{if(null==e)return!1;let t=s(e);return"String"===t||"File"===t||"Blob"===t},h=e=>JSON.stringify("Map"===s(e)?Object.fromEntries(e):e?.[Symbol.iterator]?[...e]:e),m=e=>{if(!e)return[];let t=Object.keys(e),r=t.length;for(let o=0;o<r;++o)t[o]=[t[o],e[t[o]]];return t},b=e=>{if(g(e))return e;if(f(e))return e.cloneNode(!0);if(Array.isArray(e))return S(e,Array(e.length));let t=s(e),r=e.constructor;if("Set"===t||"Map"===t)return new r(S([...e]));if(o.has(t))return new r(e);if(n.has(t)||ArrayBuffer.isView(e))return w(e);let a={};for(let t of Object.keys(e)){let r=e[t];g(r)||(r=b(r)),a[t]=r}return a},R=e=>{if(!e)return{};for(let t of Object.keys(e))delete e[t];return e},g=e=>!e||"object"!=typeof e,w=globalThis.structuredClone||(e=>e),S=(e,t=e)=>{let r=e.length;for(let o=0;o<r;++o){let r=e[o];g(r)||(r=b(r)),t[o]=r}return t},O=async(e,t,r)=>{r.method||=e.toUpperCase();let{onres:o,onError:n,transform:a,...s}=r,d={...s,input:t},c=await fetch(t,s).catch(U(d,n));if("error"in d)return c;if(c.status in i&&(c.code=i[c.status]),!c.ok){let{status:e="",code:t="UnsuccessfulResponse"}=c,r=Error(`${e} ${t}`.trim(),{cause:{status:e,code:t}});return U(c,n)(r)}let f=o?.await||o;if("function"==typeof f){let e=Symbol(c.code??c.status),t=f(c,d,e),r=u(t)&&!("await"in o),n=!r&&await t;if(l(n)&&e in n)return n}return a&&c.body&&!c.bodyUsed?c.json().catch(e=>e instanceof SyntaxError?e.message.match(/"(.*)" is not valid JSON$/)?.pop():U(c,n)(e)):c},U=(e,t)=>("function"==typeof t||(t=e=>e),r=>{(r||="Unknown Exception While Fetching...")instanceof Error||(r=Error(r));let o=setTimeout(()=>{console.error("Unhandled (in fetched-api)",r.stack||r)},10);return t(Object.defineProperty(e,"error",{enumerable:!0,configurable:!0,get:()=>(clearTimeout(o),r)})??e)}),M=(e,t,r)=>{if(!t&&!r)return e||"";let o=r?`?${new URLSearchParams(r)}`:"",n=(e?.url||`${e||""}`).trim();n.startsWith("http")&&n.startsWith(t)&&(t=""),n.startsWith("/")&&t?.endsWith("/")&&(t=t.slice(0,-1));let a=new URL((t||"")+n+o);return c(e)?new Request(a,e):a},N=(e,...t)=>{let r=Object.assign({transform:"get"===e||"post"===e||"options"===e},...t,("get"===e||"head"===e)&&{body:void 0});if(null==r.body||p(r.body))return r;let o=r.headers??=new Headers,n=o.get("content-type");return n||o.set("content-type","application/json"),r.body=/multipart\/form-data/.test(n)?(o.delete("content-type"),A(r.body)):/application\/x-www-form-urlencoded/.test(n)?new URLSearchParams(r.body):h(r.body),r},P=(...e)=>{let t={};for(let{headers:r,appendHeaders:o}of e){if(r){if(t.headers)for(let e of(r.entries||(r=m(r)),r))t.headers.set(...e);else t.headers=new Headers(r)}if(o){if(t.headers)for(let e of(o.entries||(o=m(o)),o))t.headers.append(...e);else t.headers=new Headers(o)}}return t},A=e=>{let t=new FormData;if(null==e)return t;for(let r of("object"==typeof e||(e={0:e}),Object.keys(e))){let o=e[r];y(o)||(o=h(o)),t.append(r,o)}return t},E=e=>{let r=D(L(),b(e));for(let t of a){let o=e?.[t],n="post"===t||"put"===t||"patch"===t;r[t]=C((e,...o)=>{let a=o.pop();n&&(o.length?a.body=o.pop():a={body:a});let i=P(r,r[t],a??{}),{baseURL:s,query:l,...d}=N(t,r,r[t],a,i);return O(t,M(e,s,l),d)},t),D(r[t],b(o))}return j(r,t)},{keys:F,assign:D,defineProperty:T,defineProperties:j}=Object,C=(e,t)=>T(e,"name",{value:t}),L=()=>({create:C(E,"create"),with(e){let t=E(this);return e?t.use(e):t},set(e){for(let e of(R(this),a))R(this[e]);return this.use(e)},use(e){for(let t of F(e||{})){let r=e[t];d(r)||(r=b(r));let o="function"==typeof this[t];o?D(this[t],r):this[t]=r}return this}});var q=/* @__PURE__ */E();export{b as clone,q as default,E as initapi,h as jsonify,s as type};
