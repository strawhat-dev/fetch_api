let e={configurable:!1,enumerable:!1,writable:!1},t={create:e,with:e,set:e,use:e,get:e,post:e,put:e,patch:e,delete:e,trace:e,connect:e,options:e,head:e},r=/* @__PURE__ */new Set(["ArrayBuffer","FormData","ReadableStream","SharedArrayBuffer","URLSearchParams"]),o=/* @__PURE__ */new Set(["Date","Error","Headers","RegExp","Request","Response","URL","URLSearchParams"]),n=/* @__PURE__ */new Set(["ArrayBuffer","AudioData","Blob","CropTarget","CryptoKey","DOMException","DOMMatrix","DOMMatrixReadOnly","DOMPoint","DOMPointReadOnly","DOMQuad","DOMRect","DOMRectReadOnly","File","FileList","FileSystemDirectoryHandle","FileSystemFileHandle","FileSystemHandle","GPUCompilationInfo","GPUCompilationMessage","ImageBitmap","ImageData","RTCCertificate","SharedArrayBuffer","VideoFrame"]),a=/* @__PURE__ */new Set(["get","post","put","patch","delete","trace","connect","options","head"]),i={100:"Continue",101:"SwitchingProtocols",102:"Processing",103:"EarlyHints",200:"Ok",201:"Created",202:"Accepted",203:"NonAuthoritativeInformation",204:"NoContent",205:"ResetContent",206:"PartialContent",207:"MultiStatus",208:"AlreadyReported",226:"ImUsed",300:"MultipleChoices",301:"MovedPermanently",302:"Found",303:"SeeOther",304:"NotModified",305:"UseProxy",306:"Unused",307:"TemporaryRedirect",308:"PermanentRedirect",400:"BadRequest",401:"Unauthorized",402:"PaymentRequired",403:"Forbidden",404:"NotFound",405:"MethodNotAllowed",406:"NotAcceptable",407:"ProxyAuthenticationRequired",408:"RequestTimeout",409:"Conflict",410:"Gone",411:"LengthRequired",412:"PreconditionFailed",413:"PayloadTooLarge",414:"UriTooLong",415:"UnsupportedMediaType",416:"RangeNotSatisfiable",417:"ExpectationFailed",418:"ImATeapot",421:"MisdirectedRequest",422:"UnprocessableEntity",423:"Locked",424:"FailedDependency",425:"TooEarly",426:"UpgradeRequired",428:"PreconditionRequired",429:"TooManyRequests",431:"RequestHeaderFieldsTooLarge",451:"UnavailableForLegalReasons",500:"InternalServerError",501:"NotImplemented",502:"BadGateway",503:"ServiceUnavailable",504:"GatewayTimeout",505:"HttpVersionNotSupported",506:"VariantAlsoNegotiates",507:"InsufficientStorage",508:"LoopDetected",510:"NotExtended",511:"NetworkAuthenticationRequired"},s=e=>null==e||Number.isNaN(e)?"Nullish":e.constructor?.name??Object.prototype.toString.call(e).slice(8,-1),l=e=>!e||"object"!=typeof e&&"function"!=typeof e,d=e=>!!e&&"Promise"===s(e),u=e=>!!e&&"Request"===s(e),c=e=>!!e?.ELEMENT_NODE&&"function"==typeof e.cloneNode,f=e=>p(e)||ArrayBuffer.isView(e)||r.has(s(e)),p=e=>{if(null==e)return!1;let t=s(e);return"String"===t||"File"===t||"Blob"===t},y=e=>JSON.stringify("Map"===s(e)?Object.fromEntries(e):e?.[Symbol.iterator]?[...e]:e),h=e=>{if(!e)return[];let t=Object.keys(e),r=t.length;for(let o=0;o<r;++o)t[o]=[t[o],e[t[o]]];return t},m=e=>{if(R(e))return e;if(c(e))return e.cloneNode(!0);if(Array.isArray(e))return w(e,Array(e.length));let t=s(e),r=e.constructor;if("Set"===t||"Map"===t)return new r(w([...e]));if(o.has(t))return new r(e);if(n.has(t)||ArrayBuffer.isView(e))return g(e);let a={};for(let t of Object.keys(e)){let r=e[t];R(r)||(r=m(r)),a[t]=r}return a},b=e=>{if(!e)return{};for(let t of Object.keys(e))delete e[t];return e},R=e=>!e||"object"!=typeof e,g=globalThis.structuredClone||(e=>e),w=(e,t=e)=>{let r=e.length;for(let o=0;o<r;++o){let r=e[o];R(r)||(r=m(r)),t[o]=r}return t},S=(e,t,r)=>{if(!t&&!r)return e||"";let o=r?`?${new URLSearchParams(r)}`:"",n=(e?.url||`${e||""}`).trim();n.startsWith("http")&&n.startsWith(t)&&(t=""),n.startsWith("/")&&t?.endsWith("/")&&(t=t.slice(0,-1));let a=new URL((t||"")+n+o);return u(e)?new Request(a,e):a},O=(e,...t)=>{let r=Object.assign({transform:"get"===e||"post"===e||"options"===e},...t,("get"===e||"head"===e)&&{body:void 0});if(null==r.body||f(r.body))return r;let o=r.headers??=new Headers,n=o.get("content-type");return n||o.set("content-type","application/json"),r.body=/multipart\/form-data/.test(n)?(o.delete("content-type"),M(r.body)):/application\/x-www-form-urlencoded/.test(n)?new URLSearchParams(r.body):y(r.body),r},U=(...e)=>{let t={};for(let{headers:r,appendHeaders:o}of e){if(r){if(t.headers)for(let e of(r.entries||(r=h(r)),r))t.headers.set(...e);else t.headers=new Headers(r)}if(o){if(t.headers)for(let e of(o.entries||(o=h(o)),o))t.headers.append(...e);else t.headers=new Headers(o)}}return t},M=e=>{let t=new FormData;if(null==e)return t;for(let r of("object"==typeof e||(e={0:e}),Object.keys(e))){let o=e[r];p(o)||(o=y(o)),t.append(r,o)}return t},N=async(e,t,r)=>{r.method||=e.toUpperCase();let{onres:o,onError:n,transform:a,...s}=r,l={...s,input:t},u=await fetch(t,s).catch(P(l,n));if("error"in l)return u;if(u.status in i&&(u.code=i[u.status]),!u.ok){let{status:e="",code:t="UnsuccessfulResponse"}=u,r=Error(`${e} ${t}`.trim(),{cause:{status:e,code:t}});return P(u,n)(r)}let c=o?.await||o;if("function"==typeof c){let e=c(u,l),t=d(e)&&!("await"in o),r=t?void 0:await e;if(void 0!==r)return r}return a&&u.body&&!u.bodyUsed?u.json().catch(e=>e instanceof SyntaxError?e.message.match(/"(.*)" is not valid JSON$/)?.pop():P(u,n)(e)):u},P=(e,t)=>("function"==typeof t||(t=e=>e),r=>{(r||="Unknown Exception While Fetching...")instanceof Error||(r=Error(r));let o=setTimeout(()=>{console.error("Unhandled (in fetched-api)",r.stack||r)},10);return t(Object.defineProperty(e,"error",{enumerable:!0,configurable:!0,get:()=>(clearTimeout(o),r)})??e)}),A=e=>{let r=E(T(),e&&m(e));for(let t of a){let o=e?.[t],n="post"===t||"put"===t||"patch"===t;r[t]=(e,...o)=>{let a=o.pop();n&&(o.length?a.body=o.pop():a={body:a});let i=U(r,r[t],a??{}),{baseURL:s,query:l,...d}=O(t,r,r[t],a,i);return N(t,S(e,s,l),d)},E(r[t],o&&m(o))}return F(r,t)},{assign:E,defineProperties:F,keys:D}=Object,T=()=>({create:A,with(e){let t=A(this);return e?t.use(e):t},set(e){for(let e of(b(this),a))b(this[e]);return this.use(e)},use(e){for(let t of D(e||{})){let r=e[t];l(r)||(r=m(r));let o="function"==typeof this[t];o?E(this[t],r):this[t]=r}return this}});var j=/* @__PURE__ */A();export{m as clone,j as default,A as initapi,y as jsonify,s as type};
